# UX_FLOW

## 文档目的
定义用户操作路径与关键分支。

## 当前状态
- 状态：v1 Frozen（设计冻结版）
- 流程设计：围绕“全局搜索主入口”展开

## 上下文输入
- 当前产品流程尚未冻结
- 需要支持 Raycast 风格全局搜索体验

## 预期输出
- 主路径与异常路径可执行
- 风险节点有明确提示

## 交互流程决策（Phase 1 Freeze）
1. 默认排序策略：采用“置信度 + 最近使用 + 安全约束”三因子排序。
2. 查询混合规则：自然语言与命令查询共用入口，命令词优先精确匹配。
3. 高频快捷键集合：冻结为 `Ctrl/Cmd+K`, `Enter`, `Tab`, `Esc`, `Ctrl/Cmd+R`。

## 冻结交互流程（Phase 1 Freeze）
1. 主流程 A：全局搜索触发动作
- 打开搜索面板（`Ctrl/Cmd+K`）
- 输入关键词或自然语言
- 查看分组结果（Action/Software/Download/Job/Security/AI）
- 选择条目并执行
- 返回结果反馈（成功/阻断/失败）

2. 主流程 B：通过全局搜索发起下载
- 搜索软件或来源候选
- 选择 `download start`
- 系统创建任务并显示下载状态入口
- 用户可继续在搜索面板追踪任务

3. 主流程 C：通过全局搜索处理失败任务
- 搜索 `failed jobs` / `deadletter`
- 打开任务详情
- 查看失败原因
- 触发 `retry` 或修复指引

4. 主流程 D：通过全局搜索使用 AI 助手
- 输入目标或问题（如“视频剪辑工具”“Chrome 崩溃”）
- 返回建议/修复方案
- 可继续触发下载或进入计划审阅

5. 异常流程
- 安全阻断：显示阻断原因、所需条件（confirm/gate/审批）
- 集成失败：显示可重试入口与排障建议
- 参数错误：显示可执行示例命令

6. 确认流程
- 高风险动作统一二次确认
- 显示风险级别、影响范围、回滚提示
- 用户确认后进入队列执行路径

7. 回退流程
- 任务失败后自动进入重试策略
- 达到上限进入 deadletter
- 用户可在全局搜索中一键定位并人工介入

## 更新规则
- 流程变更必须同步 UI_MAP 与 API_SPEC。
- 流程图应与实际命令行为一致。

## 关联文档
- `docs/UI_GLOBAL_SEARCH_DRAFT.md`
- `docs/UI_SHORTCUTS_DRAFT.md`
- `docs/UI_COMPONENT_SPEC_DRAFT.md`
- `docs/UI_INTERACTION_COPY_DRAFT.md`
